<html>
  <title>Feet/Inch Calculator</title>
  <body onload="updateResult()">
    <script type="text/javascript">
      function updateResult() {
        // assume success. show results elemengt and hide error element
        document.getElementById('results').style.display = "block";
        document.getElementById('error').style.display = "none";
        try {
          // get the fields and convert to numbers
          var ft = Number(document.getElementById('ft').value);
          var inch = Number(document.getElementById('inch').value);
          var num = Number(document.getElementById('num').value);
          var denom = Number(document.getElementById('denom').value);
          var times = Number(document.getElementById('times').value);
          var div = Number(document.getElementById('div').value);

          // compute total inches
          var totalInches = (ft*12 + inch + num/denom) * times / div;

          // check for bad input
          if (isNaN(totalInches)) throw "bad input";
          if (!isFinite(totalInches)) throw "divide by zero";

          document.getElementById('resultIn').textContent = totalInches;
          document.getElementById('resultFt').textContent = totalInches/12;

          // recover feet and inches form from result
          var inches = totalInches;
          ft = (inches/12)|0;
          inches = inches - ft*12;
          var frac = inches - (inches|0);
          inches = inches |0;
          var denom = 64;
          num = (frac*denom + 0.5)|0; // round
          frac = frac - num/denom;
          while (denom > 1 && num%2 === 0) {
            denom = denom/2;
            num = num/2;
          }

          // format that string and output it
          var exact, delta = "";
          if (frac === 0) {
            exact = "exactly";
          } else {
            exact = "approximately"
            delta = " (+" + frac + '")';
          }
          var str = exact + " " + ft + "' " + inches;
          if (num != 0) {
            str += " " + num + "/" + denom;
          }
          str += '"' + delta;
          document.getElementById('resultFtDetail').textContent = str;

          // format inches
          var str = exact + " " + (12*ft + inches) + '" ';
          if (num != 0) {
            str += " " + num + "/" + denom;
          }
          document.getElementById('resultInDetail').textContent = str;

          // show metric for good measure
          document.getElementById('resultMeters').textContent = String(totalInches / 39.37);
        }
        catch (e) {
          // we had an error so hide the results block and show the error block
          document.getElementById('results').style.display = "none";
          document.getElementById('error').style.display = "block";
          document.getElementById('error').textContent = String(e);
        }
      }
    </script>
    <p>
      <input type="text" onchange="updateResult()" size="4" id="ft" value="5"> ft
      <input type="text" onchange="updateResult()" size="4" id="inch" value="0"> in
      &nbsp;&nbsp;
      <input type="text" onchange="updateResult()" size="2" id="num" value="0"> /
      <input type="text" onchange="updateResult()" size="2" id="denom" value="8">
      &nbsp;&nbsp;
      times <input type="text" onchange="updateResult()" size="2" id="times" value="1">
      divided by <input type="text" onchange="updateResult()" size="2" id="div" value="1">
    </p>
    <p id="results">
      <span id="resultFt"></span> feet, <span id="resultFtDetail"></span>
      <br>
      <span id="resultIn"></span> inches, <span id="resultInDetail"></span>
      <br>
      <span id="resultMeters"></span> meters
    </p>
    </p>
    <p id="error">
      haha no
    </p>
  </body>
</html>