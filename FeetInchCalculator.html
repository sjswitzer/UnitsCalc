<html>
  <title>Feet & Inch Calculator</title>
  <body onload="updateResult()" style="font: medium helvetica, arial, sans-serif;">
    <script type="text/javascript">
      function getField(name, def) {
        document.getElementById(name).style.color = '';  // default
        var val = document.getElementById(name).value.trim();
        if (val === "") return def;
        val = Number(val);
        if (isNaN(val)) {
          document.getElementById(name).style.color = 'red';
          throw "bad input";
        }
        return val;
      }

      function updateResult() {
        // Assume success: show results element and hide error element
        document.getElementById('results').style.display = '';
        document.getElementById('error').style.display = 'none';
        try {
          var ft = getField('ft', 0);
          var inch = getField('inch', 0);
          var num = getField('num', 0);
          var denom = getField('denom', 1);
          var times = getField('times', 1);
          var div = getField('div', 1);

          var totalInches = (ft*12 + inch + num/denom) * times / div;
          if (!isFinite(totalInches)) throw "divide by zero";

          document.getElementById('resultIn').textContent = totalInches;
          document.getElementById('resultFt').textContent = totalInches/12;

          // Recover feet and inches from from result
          var inches = totalInches;
          ft = (inches/12)|0;      // "n|0" truncates to an integer
          inches = inches - ft*12;
          var frac = inches - (inches|0);
          inches = inches|0;
          var denom = 32;
          num = (frac*denom + 0.5)|0; // round
          frac = frac - num/denom;
          while (denom > 2 && num%2 === 0) {
            denom = denom/2;
            num = num/2;
          }

          // format that string and output it
          var exact, delta;
          if (frac === 0) {
            exact = "exactly";
            delta = "";
          } else {
            exact = "approximately"
            if (frac < 0)
              delta = " (" + frac + '")';   // frac will have a "-" sign already
            else
              delta = " (+" + frac + '")';  // add a "+" sign
          }
          var str = exact + " " + ft + "' " + inches;
          if (num !== 0)
            str += " " + num + "/" + denom;
          str += '"' + delta;
          document.getElementById('resultFtDetail').textContent = str;

          // format inches
          var str = exact + " " + (12*ft + inches);
          if (num !== 0)
            str += " " + num + "/" + denom;
          str += '"' + delta;
          document.getElementById('resultInDetail').textContent = str;

          // show metric for good measure
          document.getElementById('resultMeters').textContent = String(totalInches * 0.0254);
        }
        catch (e) {
          // we had an error so hide the results block and show the error block
          document.getElementById('results').style.display = 'none';
          document.getElementById('error').style.display = '';
          document.getElementById('error').textContent = String(e);
        }
      }
    </script>
    <p>
      <input type="text" onchange="updateResult()" size="4" id="ft" value="5"> ft
      <input type="text" onchange="updateResult()" size="4" id="inch" value=""> in
      &nbsp;&nbsp;
      <input type="text" onchange="updateResult()" size="2" id="num" value=""> /
      <input type="text" onchange="updateResult()" size="2" id="denom" value="8">
      &nbsp;&nbsp;
      times <input type="text" onchange="updateResult()" size="2" id="times" value="">
      divided by <input type="text" onchange="updateResult()" size="2" id="div" value="">
    </p>
    <p id="results">
      <span id="resultFt"></span> feet, <span id="resultFtDetail"></span>
      <br>
      <span id="resultIn"></span> inches, <span id="resultInDetail"></span>
      <br>
      <span id="resultMeters"></span> meters
    </p>
    </p>
    <p id="error">
    </p>
    <div style="margin-left: 2em; font-size: 85%;">
      <bl>
        <li>
          Fields may be left empty when not relevent
        </li>
        <li>
          A value like five and a half feet can be entered as 5.5 ft or as 5 ft 6 inches
        </li>
        <li>
          A value like six and a quarter inches can be entered as 6.25 inches or
          as 6 inches and 1/4
        </li>
        <li>
          Hit enter/return to calculate
        </li>
      </bl>
    </div>
  </body>
</html>